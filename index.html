<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HEAVY SHIT.</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Anton&family=Space+Grotesk:wght@300;400;700&display=swap" rel="stylesheet">
  </head>
  <body>
    <div id="root"></div>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // DOM Elements
        const artistInput = document.getElementById('artist');
        const songInput = document.getElementById('song');
        const findBtn = document.getElementById('findBtn');
        const resultDiv = document.getElementById('result');
        const playerDiv = document.getElementById('player');
        const albumArt = document.getElementById('albumArt');
        const audioPlayer = document.getElementById('audioPlayer');
        const playBtn = document.getElementById('playBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const volumeControl = document.getElementById('volumeControl');
        
        // Audio state
        let isAudioReady = false;
        
        // Initialize audio on first user interaction
        function initAudio() {
            if (!isAudioReady) {
                console.log('Audio system initialized');
                isAudioReady = true;
            }
        }
        
        // Initialize audio on ANY user interaction
        document.addEventListener('click', function initOnClick() {
            initAudio();
        }, { once: true });
        
        document.addEventListener('keydown', function initOnKeydown() {
            initAudio();
        }, { once: true });
        
        // Search for music
        findBtn.addEventListener('click', function() {
            const artist = artistInput.value.trim();
            const song = songInput.value.trim();
            
            if (!artist || !song) {
                alert('Please enter both artist and song name');
                return;
            }
            
            resultDiv.innerHTML = '<p>Searching... üîç</p>';
            playerDiv.style.display = 'none';
            
            // Simulate API call with timeout
            setTimeout(() => {
                // Generate unique ID for the song
                const songId = btoa(`${artist}-${song}`).replace(/[^a-zA-Z0-9]/g, '');
                
                // Display results
                resultDiv.innerHTML = `
                    <div class="song-result">
                        <h3>${song}</h3>
                        <p>by ${artist}</p>
                        <p class="demo-note">üéµ Now playing: Demo track</p>
                    </div>
                `;
                
                // Set up player
                albumArt.src = `https://picsum.photos/seed/${songId}/300/300`;
                albumArt.alt = `${song} by ${artist}`;
                
                // Use a reliable demo audio URL
                const demoAudioUrl = 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3';
                audioPlayer.src = demoAudioUrl;
                
                // Show player
                playerDiv.style.display = 'block';
                
                // Initialize audio
                initAudio();
                
                // Auto-play after user has interacted
                setTimeout(() => {
                    audioPlayer.play().then(() => {
                        console.log('Audio playing');
                        playBtn.style.display = 'none';
                        pauseBtn.style.display = 'inline-block';
                    }).catch(error => {
                        console.log('Auto-play blocked, waiting for user click');
                        // Show play button
                        playBtn.style.display = 'inline-block';
                        pauseBtn.style.display = 'none';
                    });
                }, 500);
                
            }, 800);
        });
        
        // Player controls
        playBtn.addEventListener('click', function() {
            initAudio();
            audioPlayer.play().then(() => {
                console.log('Audio playing');
                playBtn.style.display = 'none';
                pauseBtn.style.display = 'inline-block';
            }).catch(error => {
                console.error('Playback failed:', error);
                resultDiv.innerHTML += '<p class="error">‚ö†Ô∏è Click play again to start audio</p>';
            });
        });
        
        pauseBtn.addEventListener('click', function() {
            audioPlayer.pause();
            playBtn.style.display = 'inline-block';
            pauseBtn.style.display = 'none';
        });
        
        volumeControl.addEventListener('input', function() {
            audioPlayer.volume = this.value;
        });
        
        // Audio event listeners
        audioPlayer.addEventListener('play', function() {
            playBtn.style.display = 'none';
            pauseBtn.style.display = 'inline-block';
        });
        
        audioPlayer.addEventListener('pause', function() {
            playBtn.style.display = 'inline-block';
            pauseBtn.style.display = 'none';
        });
        
        audioPlayer.addEventListener('error', function(e) {
            console.error('Audio error:', e);
            resultDiv.innerHTML += '<p class="error">‚ùå Using demo track</p>';
            // Fallback to demo audio
            audioPlayer.src = 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3';
            setTimeout(() => audioPlayer.play(), 500);
        });
        
        // Handle Enter key in input fields
        artistInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') findBtn.click();
        });
        
        songInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') findBtn.click();
        });
        
        // Initialize player controls
        pauseBtn.style.display = 'none';
    });
</script>
  </body>
</html>
